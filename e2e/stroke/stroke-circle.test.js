import { deepEqual as eq } from 'node:assert';
import { Canvas } from '../../src/models/canvas/canvas.js';
import { Color } from '../../src/models/color/color.js';
import { Primitive } from '../../src/models/primitive/primitive.js';
import { Shape } from '../../src/models/shape/shape.js';

/** #### Creates a circle */
const makeStrokeCircle = (strokePosition) => {
    const primitive = new Primitive(
        null,                          // debugShapeAabb
        'no-flip',                     // flip
        'union',                       // operation
        'circle',                      // type
        0,                             // rotation
        1,                             // scale
        { x: 0, y: 0 },                // position
    );
    return new Shape(
        'normal',                      // blendMode
        new Color(255, 255, 255, 255), // debugShapeAabb white
        'no-flip',                     // flip
        new Color(0, 0, 255, 255),     // ink blue
        new Color(255, 0, 0, 255),     // paper red
        'breton',                      // pattern
        0.5,                           // patternRatio
        2,                             // patternScale
        'pixel',                       // patternUnit
        [ primitive ],                 // primitives
        0,                             // rotate
        3.333,                         // scale
        new Color(0, 255, 0, 255),     // strokeColor green
        strokePosition,                // strokePosition
        'pixel',                       // strokeUnit
        4.125,                         // strokeWidth
        { x: 0, y: 0 },                // translate
    );
};

/** #### Renders a stroke circle on a fresh canvas */
const renderCircle = (strokePosition) => {
    const canvas = new Canvas(new Color(10, 10, 10, 255), 40, 40);
    const shape = makeStrokeCircle(strokePosition);
    canvas.addShape(shape);
    return canvas.render('8color', 'braille');
};


// TESTS

// With strokePosition 'inside'.
eq(
    renderCircle('inside'),
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⣿⣿⣿⣿⣿⣿⣿⣿⢻⢻⢻⢺⢸⢸⢺⢻⢻⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⣿⣿⣿⣿⢻⢻⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢻⢻⣿⣿⣿⣿⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⣿⣿⢻⢸⢸⢸⢸⢸⢸⢸⢜⢜⢜⢜⢜⢜⢸⢸⢸⢸⢸⢸⢸⢻⣿⣿⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⣿⢻⢸⢸⢸⢸⢸⢜⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢜⢸⢸⢸⢸⢸⢻⣿⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⢻⢸⢸⢸⢸⢜⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢜⢸⢸⢸⢸⢻⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⢸⢸⢸⢸⢜⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢜⢸⢸⢸⢸⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢺⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢺⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢼⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢼⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⢸⢸⢸⢸⢲⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢲⢸⢸⢸⢸⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⣼⢸⢸⢸⢸⢲⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢲⢸⢸⢸⢸⣼⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⣿⣼⢸⢸⢸⢸⢸⢲⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢲⢸⢸⢸⢸⢸⣼⣿⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⣿⣿⣼⢸⢸⢸⢸⢸⢸⢸⢲⢲⢲⢲⢲⢲⢸⢸⢸⢸⢸⢸⢸⣼⣿⣿⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⣿⣿⣿⣿⣼⣼⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⣼⣼⣿⣿⣿⣿⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⣿⣿⣿⣿⣿⣿⣿⣿⣿⣼⣼⣼⢼⢸⢸⢼⣼⣼⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐',
);

eq(
    renderCircle('center'),
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢻⢻⢻⢻⢸⢸⢸⢸⢻⢻⢻⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⣿⣿⣿⣿⣿⢻⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢻⣿⣿⣿⣿⣿⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⣿⣿⢻⢸⢸⢸⢸⢸⢸⢸⢸⢜⢜⢜⢜⢜⢜⢸⢸⢸⢸⢸⢸⢸⢸⢻⣿⣿⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⣿⢻⢸⢸⢸⢸⢸⢜⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢜⢸⢸⢸⢸⢸⢻⣿⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⢸⢸⢸⢸⢸⢜⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢜⢸⢸⢸⢸⢸⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⢸⢸⢸⢸⢜⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢜⢸⢸⢸⢸⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⢸⢸⢸⢸⢲⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢲⢸⢸⢸⢸⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⢸⢸⢸⢸⢸⢲⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢲⢸⢸⢸⢸⢸⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⣿⣼⢸⢸⢸⢸⢸⢲⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢲⢸⢸⢸⢸⢸⣼⣿⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⣿⣿⣼⢸⢸⢸⢸⢸⢸⢸⢸⢲⢲⢲⢲⢲⢲⢸⢸⢸⢸⢸⢸⢸⢸⣼⣿⣿⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⣿⣿⣿⣿⣿⣼⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⣼⣿⣿⣿⣿⣿⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣼⣼⣼⣼⢸⢸⢸⢸⣼⣼⣼⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐',
);

eq(
    renderCircle('outside'),
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐\n' +
    '⢐⢐⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢻⢻⢻⢻⢸⢸⢸⢸⢻⢻⢻⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⣿⣿⣿⣿⣿⣿⢻⢻⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢻⢻⣿⣿⣿⣿⣿⣿⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⣿⣿⣿⣿⢻⢸⢸⢸⢸⢸⢸⢸⢜⢜⢜⢜⢜⢜⢜⢜⢸⢸⢸⢸⢸⢸⢸⢻⣿⣿⣿⣿⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⣿⣿⢻⢸⢸⢸⢸⢸⢜⢜⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢜⢜⢸⢸⢸⢸⢸⢻⣿⣿⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⣿⢸⢸⢸⢸⢸⢜⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢜⢸⢸⢸⢸⢸⣿⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⣿⣿⢐⢐\n' +
    '⢐⢐⣿⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⣿⢐⢐\n' +
    '⢐⢐⣿⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⣿⢐⢐\n' +
    '⢐⢐⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⢐⢐\n' +
    '⢐⢐⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⢐⢐\n' +
    '⢐⢐⣿⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⣿⢐⢐\n' +
    '⢐⢐⣿⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⣿⢐⢐\n' +
    '⢐⢐⣿⣿⢸⢸⢸⢸⢸⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢸⢸⢸⢸⢸⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⣿⢸⢸⢸⢸⢸⢲⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢲⢸⢸⢸⢸⢸⣿⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⣿⣿⣼⢸⢸⢸⢸⢸⢲⢲⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢖⢲⢲⢸⢸⢸⢸⢸⣼⣿⣿⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⣿⣿⣿⣿⣼⢸⢸⢸⢸⢸⢸⢸⢲⢲⢲⢲⢲⢲⢲⢲⢸⢸⢸⢸⢸⢸⢸⣼⣿⣿⣿⣿⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⣿⣿⣿⣿⣿⣿⣼⣼⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⢸⣼⣼⣿⣿⣿⣿⣿⣿⣿⣿⢐⢐\n' +
    '⢐⢐⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣼⣼⣼⣼⢸⢸⢸⢸⣼⣼⣼⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢐⢐\n' +
    '⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐⢐',
);


console.log('All stroke-circle e2e tests passed.');
